{% if site.style == 'dark' %}
  {% assign icon_color = "#ffffff" %}
{% else %}
  {% assign icon_color = "#24292e" %}
{% endif %}

{% assign content = page.content %}

{% assign posts_total = site.posts | size %}

{% assign user = site.github.owner %}

{% if page.path contains '_posts' %}
  {% assign page_title = page.title %}
  {% assign meta_description = page.content | strip_html | strip_newlines | xml_escape | truncate: 300 %}
{% else %}
  {% assign page_title = user.name %}
  {% assign meta_description = user.bio | strip_html | strip_newlines | xml_escape | truncate: 300 %}
{% endif %}

<!doctype html>
<html class="min-height-full {% if site.style == 'dark' %}theme-dark{% endif %}">
  <head>
    <meta charset="utf-8">
    <title>Ash在招聘-PPIO/PPLabs</title>
    <meta name="description" content="{{ meta_description }}" />
    <meta property="og:title" content="{{ user.name }}" />
    <meta property="og:image" content="{{ user.avatar_url }}" />
    <meta property="og:description" content="{{ meta_description }}" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Baidu Analytics -->
    <script>
      var _hmt = _hmt || [];
      (function() {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?406e2065031ae88b6bf40e6df80d8694";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
      })();
    </script>

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-138967165-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-138967165-1');
    </script>
    <link href="{{ "/assets/styles.css" | relative_url }}" rel="stylesheet" type="text/css">
    
    <!-- 主题切换按钮样式和颜色变量 -->
    <style>
      /* 定义根变量 - 浅色主题默认值 */
      :root {
        --bg-primary: #ffffff;
        --bg-secondary: #f6f8fa;
        --text-primary: #24292e;
        --text-secondary: #586069;
        --link-color: #0366d6;
        --border-color: #e1e4e8;
        --button-bg: #fafbfc;
        --button-text: #24292e;
        --code-bg: #f6f8fa;
        --code-text: #24292e;
      }
      
      /* 深色主题变量 */
      html.theme-dark {
        --bg-primary: #2f363d;
        --bg-secondary: #24292e;
        --text-primary: #ffffff;
        --text-secondary: #d1d5da;
        --link-color: #58a6ff;
        --border-color: #444d56;
        --button-bg: #444d56;
        --button-text: #ffffff;
        --code-bg: #1f2428;
        --code-text: #e6e6e6;
      }
      
      /* 应用变量到元素 */
      body {
        background-color: var(--bg-primary);
        color: var(--text-primary);
      }
      
      a:not(.btn) {
        color: var(--link-color);
      }
      
      p, span {
        color: var(--text-primary);
      }
      
      h1, h2, h3, h4, h5, h6 {
        color: var(--text-primary);
      }
      
      .bg-white {
        background-color: var(--bg-primary) !important;
      }
      
      .bg-gray-dark {
        background-color: var(--bg-secondary) !important;
      }
      
      pre, code {
        background-color: var(--code-bg);
        color: var(--code-text);
        border-color: var(--border-color);
      }
      
      button, .btn {
        background-color: var(--button-bg);
        color: var(--button-text);
        border-color: var(--border-color);
      }
      
      table, th, td {
        border-color: var(--border-color);
      }
      
      blockquote {
        border-left-color: var(--border-color);
        color: var(--text-secondary);
      }
      
      .text-gray {
        color: var(--text-secondary) !important;
      }
      
      /* 切换按钮样式 */
      .theme-switch-wrapper {
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 1000;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: opacity 0.3s;
        opacity: 0.7;
      }
      
      .theme-switch-wrapper:hover {
        opacity: 1;
      }
      
      .theme-switch {
        display: inline-block;
        height: 34px;
        position: relative;
        width: 60px;
      }
      
      .theme-switch input {
        display: none;
      }
      
      .slider {
        background-color: #ccc;
        bottom: 0;
        cursor: pointer;
        left: 0;
        position: absolute;
        right: 0;
        top: 0;
        transition: .4s;
        border-radius: 34px;
      }
      
      .slider:before {
        background-color: white;
        bottom: 4px;
        content: "";
        height: 26px;
        left: 4px;
        position: absolute;
        transition: .4s;
        width: 26px;
        border-radius: 50%;
      }
      
      input:checked + .slider {
        background-color: #2196F3;
      }
      
      input:checked + .slider:before {
        transform: translateX(26px);
      }
      
      .theme-icon {
        margin-right: 10px;
        font-size: 20px;
        color: var(--text-primary);
      }
      
      @media (max-width: 768px) {
        .theme-switch-wrapper {
          top: 10px;
          right: 10px;
        }
        
        .theme-switch {
          height: 28px;
          width: 50px;
        }
        
        .slider:before {
          height: 20px;
          width: 20px;
        }
        
        input:checked + .slider:before {
          transform: translateX(22px);
        }
      }
      
      @media (max-width: 500px) {
        .theme-switch-wrapper {
          top: 50px; /* 避免与导航栏重叠 */
        }
      }
      
      @media (max-width: 400px) {
        .theme-switch-wrapper {
          top: auto;
          bottom: 20px;
          right: 20px;
        }
      }
      
      /* 强制高对比度 */
      .theme-dark .text-gray {
        color: #d1d5da !important; /* 比默认的灰色更亮 */
      }
      
      .theme-dark a:not(.btn) {
        color: #58a6ff !important; /* 明亮的蓝色链接 */
      }
      
      /* 确保所有字体颜色有足够对比度 */
      .theme-dark p, 
      .theme-dark h1, 
      .theme-dark h2, 
      .theme-dark h3, 
      .theme-dark h4, 
      .theme-dark h5, 
      .theme-dark h6, 
      .theme-dark span, 
      .theme-dark li,
      .theme-dark label {
        color: #ffffff !important;
      }
      
      /* 强制处理页面上任何可能被遗漏的元素 */
      html.theme-dark * {
        --text-color-fallback: #ffffff; /* 兜底文本颜色 */
      }
      
      html.theme-dark *:not(a):not(button):not(.btn):not([class*="bg-"]):not(code):not(pre) {
        color: var(--text-primary, var(--text-color-fallback)) !important;
      }
      
      html.theme-dark [class*="bg-"] {
        background-color: var(--bg-primary) !important;
      }
      
      /* 去除所有过渡效果，实现即时切换，避免不同步问题 */
      * {
        transition: none !important;
      }
    </style>
    
    <!-- 防止主题闪烁 -->
    <script>
      (function() {
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme === 'dark') {
          document.documentElement.classList.add('theme-dark');
        } else if (savedTheme === 'light') {
          document.documentElement.classList.remove('theme-dark');
        }
      })();
    </script>
  </head>
  <body class="{% if site.style == 'dark' %}theme-dark{% else %}{% endif %} min-height-full">
  
  <!-- 主题切换按钮 -->
  <div class="theme-switch-wrapper">
    <span class="theme-icon">☀/☾</span>
    <label class="theme-switch" for="checkbox">
      <input type="checkbox" id="checkbox" {% if site.style == 'dark' %}checked{% endif %}>
      <div class="slider"></div>
    </label>
  </div>
